<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>Developers &mdash; PassiveTotal 2.0.0 documentation</title>
    
    <link rel="stylesheet" href="_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    './',
        VERSION:     '2.0.0',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="_static/jquery.js"></script>
    <script type="text/javascript" src="_static/underscore.js"></script>
    <script type="text/javascript" src="_static/doctools.js"></script>
    <link rel="top" title="PassiveTotal 2.0.0 documentation" href="index.html" />
    <link rel="next" title="API Wrappers" href="api.html" />
    <link rel="prev" title="Introduction" href="introduction.html" />
   
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9">

  </head>
  <body role="document">  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="developers">
<h1>Developers<a class="headerlink" href="#developers" title="Permalink to this headline">¶</a></h1>
<p>This client library was built with developers in mind. Our goal was to provide our clients with an easy way to use PassiveTotal data inside their own tools or organizations. Below is a walkthrough of building a simple tool to output WHOIS emails for a list of passive DNS domains. Additionally, check out our source code for &#8220;pt-client&#8221; in order to see how we used the libraries available to you to build our CLI tool.</p>
<div class="section" id="building-a-simple-tool">
<h2>Building a Simple Tool<a class="headerlink" href="#building-a-simple-tool" title="Permalink to this headline">¶</a></h2>
<p>Lets say you are doing research on an IP address and want to understand who registered the domains that have the top number of resolutions over time. Going about that inside the PassiveTotal web interface would be tedious and difficult, but easy in code.</p>
<p>For this tool, we are going to need a few system libraries, the DNS and WHOIS libraries as well as their result counterparts. We can begin by importing like this:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.dns</span> <span class="kn">import</span> <span class="n">DnsClient</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.dns</span> <span class="kn">import</span> <span class="n">DnsUniqueResult</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.whois</span> <span class="kn">import</span> <span class="n">WhoisClient</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.whois</span> <span class="kn">import</span> <span class="n">WhoisResult</span>
</pre></div>
</td></tr></table></div>
<p>Next, we want to grab the IP address from the user directly as an argument on the command line, then look up all the unique domain names that have associated with it.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">query</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># look up the unique resolutions</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">DnsClient</span><span class="o">.</span><span class="n">from_config</span><span class="p">()</span>
<span class="n">raw_results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_unique_resolutions</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="n">query</span>
<span class="p">)</span>

<span class="c"># load the result into our class</span>
<span class="n">loaded</span> <span class="o">=</span> <span class="n">DnsUniqueResult</span><span class="p">(</span><span class="n">raw_results</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>Our &#8220;loaded&#8221; variable now has the contents of the unique passive DNS call and comes with a few helper methods. The goal now is to loop over the top 3 results and perform a WHOIS look-up on them in order to get the registrant email address.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6
7</pre></div></td><td class="code"><div class="highlight"><pre><span class="n">whois_client</span> <span class="o">=</span> <span class="n">WhoisClient</span><span class="o">.</span><span class="n">from_config</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">loaded</span><span class="o">.</span><span class="n">get_records</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">raw_whois</span> <span class="o">=</span> <span class="n">whois_client</span><span class="o">.</span><span class="n">get_whois_details</span><span class="p">(</span>
        <span class="n">query</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">resolve</span>
    <span class="p">)</span>
    <span class="n">whois</span> <span class="o">=</span> <span class="n">WhoisResult</span><span class="p">(</span><span class="n">raw_whois</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">record</span><span class="o">.</span><span class="n">resolve</span><span class="p">,</span> <span class="n">whois</span><span class="o">.</span><span class="n">contactEmail</span>
</pre></div>
</td></tr></table></div>
<p>Well, that was easy. The full copy of the code should look like the following:</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.dns</span> <span class="kn">import</span> <span class="n">DnsClient</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.dns</span> <span class="kn">import</span> <span class="n">DnsUniqueResult</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.whois</span> <span class="kn">import</span> <span class="n">WhoisClient</span>
<span class="kn">from</span> <span class="nn">passivetotal.libs.whois</span> <span class="kn">import</span> <span class="n">WhoisResult</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

<span class="c"># look up the unique resolutions</span>
<span class="n">client</span> <span class="o">=</span> <span class="n">DnsClient</span><span class="o">.</span><span class="n">from_config</span><span class="p">()</span>
<span class="n">raw_results</span> <span class="o">=</span> <span class="n">client</span><span class="o">.</span><span class="n">get_unique_resolutions</span><span class="p">(</span>
    <span class="n">query</span><span class="o">=</span><span class="n">query</span>
<span class="p">)</span>

<span class="n">loaded</span> <span class="o">=</span> <span class="n">DnsUniqueResult</span><span class="p">(</span><span class="n">raw_results</span><span class="p">)</span>

<span class="n">whois_client</span> <span class="o">=</span> <span class="n">WhoisClient</span><span class="o">.</span><span class="n">from_config</span><span class="p">()</span>
<span class="k">for</span> <span class="n">record</span> <span class="ow">in</span> <span class="n">loaded</span><span class="o">.</span><span class="n">get_records</span><span class="p">()[:</span><span class="mi">3</span><span class="p">]:</span>
    <span class="n">raw_whois</span> <span class="o">=</span> <span class="n">whois_client</span><span class="o">.</span><span class="n">get_whois_details</span><span class="p">(</span>
        <span class="n">query</span><span class="o">=</span><span class="n">record</span><span class="o">.</span><span class="n">resolve</span>
    <span class="p">)</span>
    <span class="n">whois</span> <span class="o">=</span> <span class="n">WhoisResult</span><span class="p">(</span><span class="n">raw_whois</span><span class="p">)</span>
    <span class="k">print</span> <span class="n">record</span><span class="o">.</span><span class="n">resolve</span><span class="p">,</span> <span class="n">whois</span><span class="o">.</span><span class="n">contactEmail</span>
</pre></div>
</td></tr></table></div>
<p>If you wanted, you could begin extending this script more or cleaning it up a bit by placing some of the lookups inside of functon calls. Additionally, we could constrain the user input to only accepting IP addresses. Our library comes with some helpful utilities and checking if a value is an IP address is one of them.</p>
<div class="highlight-python"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>1
2
3
4
5
6</pre></div></td><td class="code"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">passivetotal.common.utilities</span> <span class="kn">import</span> <span class="n">is_ip</span>

<span class="n">query</span> <span class="o">=</span> <span class="n">sys</span><span class="o">.</span><span class="n">argv</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="k">if</span> <span class="ow">not</span> <span class="n">is_ip</span><span class="p">(</span><span class="n">query</span><span class="p">):</span>
    <span class="k">raise</span> <span class="ne">Exception</span><span class="p">(</span><span class="s">&quot;This script only accepts valid IP addresses!&quot;</span><span class="p">)</span>
    <span class="n">sys</span><span class="o">.</span><span class="n">exit</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
<p>For more ideas or help in using our libraries, check out our source code on Github.</p>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
  <h3><a href="index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">Developers</a><ul>
<li><a class="reference internal" href="#building-a-simple-tool">Building a Simple Tool</a></li>
</ul>
</li>
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="introduction.html" title="previous chapter">Introduction</a></li>
      <li>Next: <a href="api.html" title="next chapter">API Wrappers</a></li>
  </ul></li>
</ul>
</div>
  <div role="note" aria-label="source link">
    <h3>This Page</h3>
    <ul class="this-page-menu">
      <li><a href="_sources/developers.txt"
            rel="nofollow">Show Source</a></li>
    </ul>
   </div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    <p class="searchtip" style="font-size: 90%">
    Enter search terms or a module, class or function name.
    </p>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2016, Brandon Dixon.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.3.1</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.6</a>
      
      |
      <a href="_sources/developers.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>